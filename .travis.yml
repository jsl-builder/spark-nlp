sudo: required

jobs:
  include:
    - language: scala
      scala:
        - 2.11.12
      os:
        - linux
      jdk:
        - openjdk8
      env:
        global:
          JAVA_OPTS=-Xmx4g
      cache:
        directories:
          - $HOME/.spark_nlp.dep.cache
          - $HOME/.m2
      before_install:
        - if [ "$TRAVIS_OS_NAME" = "osx" ]; then brew update; fi
        - if [ "$TRAVIS_OS_NAME" = "osx" ]; then brew install sbt; fi
      script:
        - sbt ++$TRAVIS_SCALA_VERSION test
    - language: python
      python:
         - "3.6"
         - "3.7"
         - "pypy3"
      os:
        - linux
      before_install:
        - if [ "$TRAVIS_OS_NAME" = "osx" ]; then brew update; fi
        - if [ "$TRAVIS_OS_NAME" = "osx" ]; then brew install sbt; fi
        - pip install pyspark==2.4.4 numpy
        - export PYSPARK_PYTHON=python3.6
        - export PYSPARK_DRIVER_PYTHON=python3.6
      script:
        - sbt assemblyAndCopy
        - cd python; python3 run-tests.py || python run-tests.py;